{"version":3,"sources":["script/svgIntegrationB.js","img/6603-17.svg","App.js","reportWebVitals.js","index.js"],"names":["ASIArray","logycalStateTimer","logycalStatexmlHttp","physicalStatexmlHttp","svg","logycalStateUrl","physicalStateUrl","svgdoc","gpart","gArrows","htmlCont","objContainer","btnFault","btnWarning","contDiv","rootGroup","faultArray","pTimerInterval","lTimerInterval","selectedFloor","arrowFlag","transform","ASI","val","duration","pStart","svgElement","flowPath","getPointAtLength","pEnd","getTotalLength","PosX","x","y","forEach","o","grpObj","animate","offsetDistance","fill","iterations","LOCKED","lockIcon","udcObjArr","arrObj","udcObj","p","Id_Percorso","seqObj","d","destObj","center","filter","a","DEST","SeqFromASI","moveUdc","item","length","svgEl","itemRotation","Rotation","parentElement","appendChild","style","offsetPath","offsetRotate","willChange","offsetAnchor","getBBox","width","xScale","height","yScale","rackOriginObjX","deltaX","deltaY","offsetX","QuotaDepositoX","renderLength","createSVGPoint","offsetY","QuotaDeposito","rackOriginObjZ","tTf","rTf","tS","setAttributeNS","remove","push","deltaTransformPoint","matrix","point","c","b","decomposeMatrix","px","py","skewX","Math","PI","atan2","skewY","translateX","e","translateY","f","scaleX","sqrt","scaleY","rotation","getRelativeXY","element","ctm","getCTM","matrixTransform","onlyUnique","value","index","self","indexOf","logicalStateFetch","url","Scale","Force","getAnimations","some","playState","XMLHttpRequest","onreadystatechange","readyState","status","data","JSON","parse","responseText","map","obj","LARGHEZZA","PROFONDITA","ALTEZZA","LARGHEZZATUNNEL","OffsetSottoComponente","posHeight","posLength","posWidth","Sequenza_Percorso","find","asiItem","SORG","ID_COMPONENTE","PIANO","COLONNA","PARTITION","Id_Tipo_Stato_Percorso","hasFault","hasWarning","LUNGHEZZA","ID_TIPO_COMPONENTE","querySelector","substring","prevObj","svgOFFSET","x1Start","y1Start","x2Start","y2Start","x1End","y1End","x2End","y2End","partitionObj","createElementNS","rootElement","namespaceURI","pWrap","append","points","pointerEvents","ID_TIPO_PARTIZIONE","txtObj","elArray","querySelectorAll","console","error","ItemG","wL","includes","replace","req","open","split","onload","g","DOMParser","parseFromString","getElementsByTagName","i","isNaN","charAt","id","fpGRoup","getElementById","elRotation","removeAttributeNS","tagName","getAttributeNS","persistent","send","addEventListener","target","statusLayer","onpointerout","log","udcObjItem","undefined","Id_Udc","seqItem","ASIArrayObj","svgItemDest","color","stroke","seqPath","destPoint","sPoint","strokeWidth","gUdc","udc","findIndex","standingASI","udcIndex","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","err","return","splice","svgUdc","udcColour","emptyUdc","emptyUdcObj","Codice_Udc","epObj","setTimeout","Motivo_Blocco","parser","childNodes","message","physicalStateFetch","pUrl","jsonData","tagType","document","createElement","setAttribute","innerText","onclick","setRequestHeader","tagObj","asi","activeSequence","asiObj","this","asiInFault","startsWith","flat","el","faultRect","htmlContainer","svgLayout","cfg","Provider","Psm","elem","contentDocument","arrow","marker1","marker2","cloneNode","marker4","defs","innerHTML","FloorFilterVisible","zIndex","position","className","insertBefore","flDiv","flButton","flDivInt","choiceButton","abort","clearTimeout","sl","udcItemArray","arrowDiv","classList","contains","SVG","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.781558ff.chunk.js","sourcesContent":["/* eslint-disable */\r\nvar ASIArray;\r\nvar logycalStateTimer;\r\nvar physicalStateTimer;\r\nvar logycalStatexmlHttp;\r\nvar physicalStatexmlHttp;\r\nvar faultArray = [];\r\nvar pTimerInterval = 2000;\r\nvar lTimerInterval = 2000;\r\nvar svg;\r\nvar panZoom;\r\nvar logycalStateUrl;\r\nvar physicalStateUrl;\r\nvar svgContainer;\r\nvar selectedFloor = 1;\r\nvar svgdoc;\r\nvar gpart, gArrows;\r\nvar htmlCont;\r\nvar objContainer;\r\nvar arrowFlag = false;\r\nvar btnFault;\r\nvar btnWarning;\r\nvar contDiv;\r\nvar rootGroup;\r\n\r\nexport function SVG(elem, cfg) {\r\n    logycalStateUrl = cfg.Provider;\r\n    physicalStateUrl = cfg.Psm;\r\n\r\n    var Scale = cfg.Scale ? cfg.Scale : 1;\r\n    var Rotation = cfg.Rotation ? cfg.Rotation : 0;\r\n\r\n    objContainer = elem;\r\n    htmlCont = elem.parentElement;\r\n    svgdoc = elem.contentDocument;\r\n    svgContainer = svgdoc.getElementById(\"svgContainer\");\r\n    svgContainer.style.pointerEvents = 'none';\r\n    rootGroup = svgdoc.getElementById('root');\r\n    svg = svgdoc.getElementById(\"gLAYOUT\");\r\n    gpart = svgdoc.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\r\n    gpart.setAttributeNS(null, \"id\", \"gpart\");\r\n    svg.appendChild(gpart);\r\n    gArrows = svgdoc.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\r\n    gArrows.setAttributeNS(null, \"id\", \"gArrows\");\r\n    svg.appendChild(gArrows);\r\n    ASIArray = [];\r\n\r\n    // creo la freccia che verrà assegnata come markerEnd della linea.\r\n    var arrow = svgdoc.createElementNS(\"http://www.w3.org/2000/svg\", 'path');\r\n    arrow.setAttributeNS(null, \"d\", \"M0,0 L0,6 L9,3 z\");\r\n    svg.appendChild(arrow);\r\n\r\n    // MARKER BLUE WAITING\r\n    var marker1 = svgdoc.createElementNS(\"http://www.w3.org/2000/svg\", \"marker\");\r\n    marker1.setAttributeNS(null, 'id', 'markerTriangolo1');\r\n    marker1.setAttributeNS(null, \"markerWidth\", 10);\r\n    marker1.setAttributeNS(null, \"markerHeight\", 10);\r\n    marker1.setAttributeNS(null, \"markerUnits\", \"strokeWidth\");\r\n    marker1.setAttributeNS(null, \"refX\", 5);\r\n    marker1.setAttributeNS(null, \"refY\", 3);\r\n    marker1.setAttributeNS(null, \"orient\", \"auto\");\r\n    marker1.setAttributeNS(null, \"fill\", \"#007bff\");\r\n    marker1.appendChild(arrow);\r\n\r\n    // MARKER GREEN RUNNING\r\n    var marker2 = marker1.cloneNode(true);\r\n    marker2.setAttributeNS(null, 'id', 'markerTriangolo2');\r\n    marker2.setAttributeNS(null, \"fill\", \"green\");\r\n\r\n    // MARKER YELLOW WARNING\r\n    var marker4 = marker1.cloneNode(true);\r\n    marker4.setAttributeNS(null, 'id', 'markerTriangolo4');\r\n    marker4.setAttributeNS(null, \"fill\", \"yellow\");\r\n\r\n    // APPENDO I MARKER ALL SVG\r\n    var defs = svgdoc.createElementNS(\"http://www.w3.org/2000/svg\", 'defs')\r\n    svg.appendChild(defs);\r\n\r\n    defs.appendChild(marker1);\r\n    defs.appendChild(marker2);\r\n    defs.appendChild(marker4);\r\n\r\n    var style = svgdoc.createElementNS(\"http://www.w3.org/2000/svg\", 'style');\r\n    style.innerHTML = \".statusLayer {fill: #044b94;opacity: 0.5;} .fault {fill: #FF0000;opacity: 0.5;}\"\r\n\r\n    defs.appendChild(style);\r\n    \r\n    // // WRAPPNG SVG IN ELEMENTO ZOOM.\r\n    // panZoom = svgPanZoom(svgContainer, {\r\n    //     onUpdatedCTM: function onUpdatedCTM() {\r\n    //         var popover = $(document.getElementById(\"divSVGContainer\")).find('.popover');\r\n    //         if (popover) popover.popover('update');\r\n    //     }\r\n    // });\r\n\r\n    btnWarning = null;\r\n    btnFault = null;\r\n\r\n    // SE è SPECIFICATA UNA ROTAZIONE NELLA ACTION PARAMETER WIDGET RUOTO L'SVG ED I TESTI.\r\n    if (Rotation != 0 && Rotation) {\r\n        if (Rotation == 1) {\r\n            rootGroup.setAttribute(\"transform\", \"rotate(90 \" + rootGroup.getBBox().width * 0.5 + ' ' + rootGroup.getBBox().height * 0.5 + ')');\r\n            // panZoom.updateBBox();\r\n        } else if (Rotation == 2) {\r\n            rootGroup.setAttribute(\"transform\", \"rotate(180 \" + rootGroup.getBBox().width * 0.5 + ' ' + rootGroup.getBBox().height * 0.5 + ')');\r\n        } else if (Rotation == 3) {\r\n            rootGroup.setAttribute(\"transform\", \"rotate(270 \" + rootGroup.getBBox().width * 0.5 + ' ' + rootGroup.getBBox().height * 0.5 + ')');\r\n            // panZoom.updateBBox();\r\n        } else if (Rotation) {\r\n            rootGroup.setAttribute(\"transform\", \"rotate(\" + Rotation + \" \" + rootGroup.getBBox().width * 0.5 + ' ' + rootGroup.getBBox().height * 0.5 + ')');\r\n            // panZoom.updateBBox();\r\n        }\r\n\r\n        // I TESTI LI RUOTO SOLO SE LA ROTAZIONE è 180\r\n        //if (Rotation == 2) Array.prototype.forEach.call(svg.getElementsByTagName(\"text\"), function (textItem) {\r\n        //    textItem.setAttribute(\"transform\", \"rotate(180 \" + (textItem.getBBox().x + textItem.getBBox().width / 2) + ' ' + (textItem.getBBox().y + textItem.getBBox().height / 2) + ')');\r\n        //});\r\n    }\r\n\r\n    // FIT AL CONTAINER CONSIDERANDO ROTAZIONE.\r\n    // panZoom.fit();\r\n\r\n    // SE IL FILTRO DEI PIANI NON è VISIBLE MANDO 0 COME FILTRO (TIRA SU TUTTI I PIANI);\r\n    if (cfg.FloorFilterVisible == false) selectedFloor = 0;\r\n\r\n    // POLLING LOGYCAL STATUS\r\n    logycalStateTimer = setTimeout(logicalStateFetch, lTimerInterval, logycalStateUrl + \"/Scada/0/\" + selectedFloor, svgdoc, Rotation, Scale);\r\n\r\n    // POLLING PHYSICAL STATUS\r\n    physicalStateTimer = setTimeout(physicalStateFetch, pTimerInterval, physicalStateUrl + '/psm/livestatus', Scale);\r\n\r\n    contDiv = document.createElement('div');\r\n    contDiv.style.zIndex = 1;\r\n    contDiv.style.position = 'absolute';\r\n    contDiv.className = 'd-flex flex-column';\r\n    htmlCont.insertBefore(contDiv, objContainer);\r\n\r\n    // AGGIUNGO IL FILTRO DEI PIANI\r\n    var req = new XMLHttpRequest();\r\n\r\n    req.open(\"GET\", logycalStateUrl + \"/Scada/getFloors\", true);\r\n\r\n    req.onload = function () {\r\n        if (req.readyState == 4 && req.status == 200) {\r\n            var data = JSON.parse(req.responseText);\r\n            var flDiv = document.createElement('div');\r\n            flDiv.id = \"floorsFilter\";\r\n            flDiv.setAttribute(\"class\", \"dropdown bg-white m-2\");\r\n            var flButton = document.createElement('button');\r\n            flButton.setAttribute(\"class\", \"btn btn-outline-primary dropdown-toggle w-100\");\r\n            flButton.setAttribute(\"data-toggle\", \"dropdown\");\r\n            flButton.setAttribute(\"type\", \"button\");\r\n            flButton.setAttribute(\"aria-haspopup\", \"true\");\r\n            flButton.setAttribute(\"aria-expanded\", \"false\");\r\n            flButton.setAttribute(\"id\", \"dropdownMenu2\");\r\n            flButton.innerHTML = \"Livello : 1\";\r\n            flDiv.appendChild(flButton);\r\n            var flDivInt = document.createElement('div');\r\n            flDiv.appendChild(flDivInt);\r\n            flDivInt.setAttribute(\"aria-labelledby\", \"dropdownMenu2\");\r\n            flDivInt.setAttribute(\"class\", \"dropdown-menu\");\r\n            data.map(function (item) {\r\n                return item.PIANO;\r\n            }).filter(onlyUnique).forEach(function (val) {\r\n                var choiceButton = document.createElement('button');\r\n                choiceButton.setAttribute(\"class\", \"dropdown-item\");\r\n                choiceButton.setAttribute(\"type\", \"button\");\r\n                choiceButton.innerHTML = val;\r\n                choiceButton.onclick = function () {\r\n                    //Fermo la richiesta in corso.\r\n                    logycalStatexmlHttp.abort();\r\n                    //Fermo il timer.\r\n                    clearTimeout(logycalStateTimer);\r\n                    //Cancello il rendering attuale.\r\n                    ASIArray.filter(function (ASI) {\r\n                        return ASI.PIANO == selectedFloor;\r\n                    }).forEach(function (ASI) {\r\n                        clearPopovers();\r\n\r\n                        if (ASI.svgElement.length > 0) {\r\n                            ASI.svgElement.forEach(function (arrObj) {\r\n                                arrObj.grpObj.remove();\r\n                                if (arrObj.txtObj) arrObj.txtObj.remove();\r\n                            });\r\n\r\n                            if (ASI.svgElement[0].seqObj) ASI.svgElement[0].seqObj.remove();\r\n                            var sl = svg.getElementById(\"sl\" + ASI.ASI);\r\n                            if (sl) sl.remove();\r\n\r\n                            var lockIcon = svgdoc.getElementById(\"lock\" + ASI.ASI);\r\n                            if (lockIcon) lockIcon.remove();\r\n                        }\r\n\r\n                        ASI.udcObjArr.forEach(function (udcItemArray) {\r\n                            udcItemArray.udcObj.remove();\r\n                        });\r\n\r\n                        if (ASI.destObj) {\r\n                            ASI.svgElement[0].destObj.grpObj.remove();\r\n                        }\r\n                    });\r\n                    //Per il momento per comodità svuoto tutto l array.\r\n                    ASIArray = ASIArray.filter(function (ASI) {\r\n                        return ASI.PIANO != selectedFloor || ASI.PIANO == 0 || ASI.PIANO == null;\r\n                    });\r\n\r\n                    //Imposto la variabile del piano selezionato che verrà usata dalla query\r\n                    selectedFloor = val;\r\n                    //Aggiorno il testo del bottone.\r\n                    flButton.innerHTML = \"Livello: \" + val;\r\n                    //Rifaccio partire il timer.\r\n                    logycalStateTimer = setTimeout(logicalStateFetch, lTimerInterval, logycalStateUrl + \"/Scada/0/\" + selectedFloor, svgdoc, Rotation, Scale, true);\r\n                };\r\n\r\n                flDivInt.appendChild(choiceButton);\r\n            });\r\n\r\n            contDiv.appendChild(flDiv);\r\n        }\r\n    };\r\n\r\n    req.send();\r\n\r\n    var arrowDiv = document.createElement('div');\r\n    arrowDiv.setAttribute(\"class\", \"btn-group-toggle m-2 bg-white\");\r\n    arrowDiv.setAttribute(\"data-toggle\", \"buttons\");\r\n    arrowDiv.innerHTML = '<label class=\"btn btn-outline-primary w-100\"><input type=\"checkbox\" autocomplete=\"off\">Show steps</label></div>'\r\n    arrowDiv.onclick = function (e) {\r\n        arrowFlag = !(e.target.classList.contains('active'));\r\n    }\r\n    contDiv.appendChild(arrowDiv);\r\n}\r\n\r\nexport function resetSequence(asi) {\r\n    var req = new XMLHttpRequest();\r\n\r\n    req.onreadystatechange = function () {\r\n        if (req.readyState == 4 && req.status == 200) {\r\n            console.log(req.responseText);\r\n        }\r\n    };\r\n\r\n    req.open(\"POST\", physicalStateUrl + '/psm/resetSequence', true);\r\n\r\n    req.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\r\n\r\n    req.send(JSON.stringify(ASIArray.filter(function (asiObj) {\r\n        return asiObj.ASI == asi;\r\n    })[0].activeSequence));\r\n} \r\n\r\nfunction transform(ASI, val) {\r\n    var duration = pTimerInterval;\r\n\r\n    var pStart = ASI.svgElement[0].flowPath.getPointAtLength(0);\r\n    var pEnd = ASI.svgElement[0].flowPath.getPointAtLength(ASI.svgElement[0].flowPath.getTotalLength());\r\n\r\n    if (val < ASI.PosX && pStart.x === pEnd.x && pStart.y === pEnd.y) {\r\n        duration = 0;\r\n    }\r\n\r\n    if (val > ASI.svgElement[0].flowPath.getTotalLength()) {\r\n        duration = 0;\r\n        val = ASI.svgElement[0].flowPath.getTotalLength();\r\n    }\r\n\r\n    if (ASI.PosX != val) {\r\n        ASI.svgElement.forEach(o => o.grpObj.animate({ offsetDistance: val * 100 / ASI.svgElement[0].flowPath.getTotalLength() + '%' }\r\n            ,{\r\n                fill: 'forwards',\r\n                duration: duration,\r\n                iterations: 1\r\n            })\r\n        );\r\n\r\n        if (ASI.LOCKED)\r\n        ASI.lockIcon.animate({ offsetDistance: val * 100 / ASI.svgElement[0].flowPath.getTotalLength() + '%' },{\r\n            fill: 'forwards',\r\n            duration: duration,\r\n            iterations: 1\r\n            });\r\n\r\n        // traslo l udc se è ancora sulla macchina\r\n        ASI.udcObjArr.forEach(function (arrObj) {\r\n            arrObj.udcObj.animate({ offsetDistance: val * 100 / ASI.svgElement[0].flowPath.getTotalLength() + '%' }, {\r\n                fill: 'forwards',\r\n                duration: duration,\r\n                iterations: 1\r\n            });\r\n        });\r\n\r\n        var p = ASI.svgElement[0].flowPath.getPointAtLength(val);\r\n        // traslo l'origine della freccia sequenza se esiste\r\n\r\n        if (ASI.Id_Percorso) \r\n            ASI.svgElement[0].seqObj.animate({ d: 'path(\"M' + p.x + \",\" + p.y + \" L\" + ASI.svgElement[0].destObj.center.x + \",\" + ASI.svgElement[0].destObj.center.y + '\")' }, {\r\n                fill: 'forwards',\r\n                duration: duration,\r\n                iterations: 1\r\n            });\r\n        \r\n\r\n        ASIArray.filter(a => a.DEST == ASI.ASI).forEach(function (SeqFromASI) {\r\n            if (SeqFromASI && SeqFromASI.svgElement[0].seqObj) {\r\n                SeqFromASI.svgElement[0].seqObj.animate({ d: 'path(\"M' + SeqFromASI.svgElement[0].center.x + \",\" + SeqFromASI.svgElement[0].center.y + \" L\" + p.x + \",\" + p.y + '\")' }, {\r\n                    fill: 'forwards',\r\n                    duration: duration,\r\n                    iterations: 1\r\n                });\r\n            }\r\n        })\r\n        \r\n        ASI.PosX = val;\r\n    }\r\n}\r\n\r\nfunction moveUdc(udcObj, item, ASI) {\r\n    if (ASI.svgElement.length > 0 ) {\r\n        var svgEl = ASI.svgElement[ASI.svgElement.length - 1]; \r\n        // IL CAMPO ROTATION INDICA COME è ORIENTATA L'UDC SULL ITEM RISPETTO ALL ASSE X.\r\n        var itemRotation = 0\r\n        if (item.Rotation == 1) itemRotation = 90;\r\n        else if (item.Rotation == 2) itemRotation = 180;\r\n        else if (item.Rotation == 3) itemRotation = 270;\r\n        else if (item.Rotation) itemRotation = item.Rotation;\r\n\r\n        var p;\r\n\r\n        svgEl.grpObj.parentElement.appendChild(udcObj.udcObj);\r\n\r\n        if (svgEl.grpObj.style.offsetPath) {\r\n            udcObj.udcObj.style.offsetPath = svgEl.grpObj.style.offsetPath;\r\n            udcObj.udcObj.style.offsetDistance = ASI.PosX + 'px';\r\n            udcObj.udcObj.style.offsetRotate = \"auto \" + itemRotation + 'deg'\r\n            udcObj.udcObj.style.willChange = \"transform\"\r\n            udcObj.udcObj.style.offsetAnchor = (udcObj.udcObj.getBBox().x + udcObj.udcObj.getBBox().width / 2 * udcObj.xScale) + 'px ' + (udcObj.udcObj.getBBox().y + udcObj.udcObj.getBBox().height / 2 * udcObj.yScale) + 'px'\r\n        }\r\n        else {\r\n            udcObj.udcObj.style.offsetPath = null;\r\n            udcObj.udcObj.style.offsetRotate = null;\r\n            udcObj.udcObj.style.offsetAnchor = null;\r\n            udcObj.udcObj.style.offsetDistance = null;\r\n            udcObj.udcObj.style.willChange = null;\r\n\r\n            if (!svgEl.rackOriginObjX) p = svgEl.center\r\n            else {\r\n                var deltaX, deltaY;\r\n\r\n                var offsetX = svgEl.grpObj.getBBox().width / 2;\r\n                if (item.QuotaDepositoX != null) offsetX = item.QuotaDepositoX * 3.543;\r\n\r\n                deltaX = svgEl.rackOriginObjX.getPointAtLength(svgEl.renderLength + offsetX).x - svgEl.rackOriginObjX.getPointAtLength(0).x;\r\n                deltaY = svgEl.rackOriginObjX.getPointAtLength(svgEl.renderLength + offsetX).y - svgEl.rackOriginObjX.getPointAtLength(0).y;\r\n\r\n                p = svg.createSVGPoint();\r\n\r\n                var offsetY = svgEl.grpObj.getBBox().height / 2;\r\n                if (item.QuotaDeposito != null) offsetY = item.QuotaDeposito * 3.543;\r\n\r\n                p.x = svgEl.rackOriginObjZ.getPointAtLength(offsetY).x + deltaX;\r\n                p.y = svgEl.rackOriginObjZ.getPointAtLength(offsetY).y + deltaY;\r\n            }\r\n        }\r\n\r\n        var tTf = \"\"\r\n        if (p) tTf = 'translate(' + [p.x - udcObj.udcObj.getBBox().width * udcObj.xScale / 2, p.y - udcObj.udcObj.getBBox().height * udcObj.yScale / 2] + ')';\r\n\r\n        var rTf = \"\";\r\n        if (p) rTf = 'rotate(' + item.Rotation  + ', ' + p.x + ', ' + p.y + ')';\r\n\r\n        var sTf = \"\";\r\n        sTf = 'scale(' + udcObj.xScale + ',' + udcObj.yScale + ')';\r\n\r\n        var tS = rTf + tTf + sTf;\r\n\r\n        udcObj.udcObj.setAttributeNS(null, \"transform\", tS);\r\n        \r\n        // udcObj.udcObj.animate({ transform: rTf },{\r\n        //     fill: 'forwards',\r\n        //     duration: 0,\r\n        //     iterations: 1\r\n        // });\r\n\r\n        // udcObj.udcObj.animate({ transform: tTf + sTf },{\r\n        //     fill: 'forwards',\r\n        //     duration: 0,\r\n        //     iterations: 1\r\n        // });\r\n    } else udcObj.udcObj.remove();\r\n    \r\n    //Metto l oggetto udc nell array dell oggetto asi\r\n    ASI.udcObjArr.push(udcObj);\r\n}\r\n\r\nfunction deltaTransformPoint(matrix, point) {\r\n    var dx = point.x * matrix.a + point.y * matrix.c + 0;\r\n    var dy = point.x * matrix.b + point.y * matrix.d + 0;\r\n    return { x: dx, y: dy };\r\n}\r\n\r\nfunction decomposeMatrix(matrix) {\r\n    // calculate delta transform point\r\n    var px = deltaTransformPoint(matrix, { x: 0, y: 1 });\r\n    var py = deltaTransformPoint(matrix, { x: 1, y: 0 });\r\n\r\n    // calculate skew\r\n    var skewX = 180 / Math.PI * Math.atan2(px.y, px.x) - 90;\r\n\r\n    if (skewX < 0) skewX = 360 - skewX * -1;\r\n\r\n    var skewY = 180 / Math.PI * Math.atan2(py.y, py.x);\r\n\r\n    return {\r\n        translateX: matrix.e,\r\n        translateY: matrix.f,\r\n        scaleX: Math.sqrt(matrix.a * matrix.a + matrix.b * matrix.b),\r\n        scaleY: Math.sqrt(matrix.c * matrix.c + matrix.d * matrix.d),\r\n        skewX: skewX,\r\n        skewY: skewY,\r\n        rotation: skewX\r\n    };\r\n}\r\n\r\nfunction getRelativeXY(x, y, svg, element) {\r\n    var p = svg.createSVGPoint();\r\n    var ctm = element.getCTM();\r\n    p.x = x;\r\n    p.y = y;\r\n    return p.matrixTransform(ctm);\r\n}\r\n\r\nfunction onlyUnique(value, index, self) {\r\n    return self.indexOf(value) === index;\r\n}\r\n\r\nexport function fitSVG() {\r\n    setTimeout(function () {\r\n        panZoom.resize();\r\n        panZoom.fit();\r\n        panZoom.center();\r\n    }, 500);\r\n}\r\n\r\nfunction initSl(obj, element) {\r\n    //ISTANZIO IL TOOLTIP SULL'ELEMENTO HTML SE NON ESISTE IL CONTESTO DATI, ALTRIMENTI ALLINEO LA SELEZIONE.\r\n    // $(element).popover({\r\n    //     container: document.getElementById(\"divSVGContainer\"),\r\n    //     placement: 'top',\r\n    //     html: true,\r\n    //     title: function title() {\r\n    //         var title = document.createElement(\"div\");\r\n    //         title.setAttribute(\"class\", \"d-flex flex-row justify-content-between\");\r\n\r\n    //         if (!obj.Id_Udc) {\r\n    //             title.innerText = \"POS: \" + obj.ASI;\r\n    //         } else {\r\n    //             title.innerText = 'UDC: ' + obj.Codice_Udc;\r\n    //         }\r\n\r\n    //         var closeButton = document.createElement(\"button\");\r\n    //         closeButton.setAttribute(\"class\", \"close\");\r\n    //         closeButton.setAttribute(\"type\", \"button\");\r\n    //         closeButton.setAttribute(\"aria-label\", \"Close\");\r\n    //         closeButton.onclick = function () {clearPopovers();};\r\n    //         closeButton.innerHTML = '<span aria-hidden=\"true\" >&times;</span>';\r\n\r\n    //         title.append(closeButton);\r\n\r\n    //         return title;\r\n    //     },\r\n    //     content: function content() {\r\n    //         var tmpId = $.now();\r\n    //         var htmlString = '<table id=' + tmpId + ' class=\"table\"><tbody>';\r\n    //         if (obj.ALTEZZA) htmlString += '<tr><th scope=\"row\">ALTEZZA:</th><td>' + obj.ALTEZZA + '</td></tr>';\r\n    //         if (obj.LARGHEZZA) htmlString += '<tr><th scope=\"row\">LARGHEZZA:</th><td>' + obj.LARGHEZZA + '</td></tr>';\r\n    //         if (obj.LUNGHEZZA) htmlString += '<tr><th scope=\"row\">LUNGHEZZA:</th><td>' + obj.LUNGHEZZA + '</td></tr>';\r\n\r\n    //         if (!obj.Id_Udc) {\r\n    //             htmlString += '<tr><th scope=\"row\" class=\"text-right\">UDC#:</th><td class=\"text-left\">' + obj.udcObjArr.length + '</td></tr>';\r\n    //             if (obj.Motivo_Blocco) htmlString += '<tr><th scope=\"row\" class=\"text-right\">MOTIVO BLOCCO:</th><td class=\"text-left\">' + obj.Motivo_Blocco + '</td></tr>';\r\n    //             if (obj.activeSequence) {\r\n    //                 htmlString +=   '<tr class=\"table-active\"><td>SEQUENZA ATTIVA</td>';\r\n    //                 htmlString +=   '<td>'\r\n    //                                     + '<button type=\"button\" class=\"btn btn-primary\" onclick=\"resetSequence(\\'' + obj.ASI + '\\')\">'\r\n    //                                     + '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-bootstrap-reboot\" viewBox=\"0 0 16 16\">'\r\n    //                                     + '<path d=\"M1.161 8a6.84 6.84 0 1 0 6.842-6.84.58.58 0 0 1 0-1.16 8 8 0 1 1-6.556 3.412l-.663-.577a.58.58 0 0 1 .227-.997l2.52-.69a.58.58 0 0 1 .728.633l-.332 2.592a.58.58 0 0 1-.956.364l-.643-.56A6.812 6.812 0 0 0 1.16 8z\"></path>' + '<path d=\"M6.641 11.671V8.843h1.57l1.498 2.828h1.314L9.377 8.665c.897-.3 1.427-1.106 1.427-2.1 0-1.37-.943-2.246-2.456-2.246H5.5v7.352h1.141zm0-3.75V5.277h1.57c.881 0 1.416.499 1.416 1.32 0 .84-.504 1.324-1.386 1.324h-1.6z\"></path>'\r\n    //                                     + '</svg>'\r\n    //                                     + '</button>';\r\n    //                                 '</td></tr>';\r\n    //             }\r\n\r\n    //             faultArray.filter(function (activeFault) {\r\n    //                 if (activeFault.asi != null) return activeFault.asi.split(',').findIndex(function (asiInFault) {\r\n    //                     return obj.ASI.startsWith(asiInFault);\r\n    //                 }) != -1;else return false;\r\n    //             }).forEach(function (activeFault, index) {\r\n    //                 htmlString += '<tr class=\"table-danger\"><td colspan=\"2\">' + activeFault.description + '</td></tr>';\r\n    //             });\r\n    //         } else {\r\n    //             var req = new XMLHttpRequest();\r\n\r\n    //             req.onreadystatechange = function () {\r\n    //                 if (req.readyState == 4 && req.status == 200) {\r\n    //                     var data = JSON.parse(req.responseText);\r\n\r\n    //                     data.forEach(function (itemData) {\r\n    //                         htmlString += '<tr><th scope=\"row\">CONTENUTO:</th><td>' + itemData.Codice_Articolo + \"<br/>\" + itemData.Descrizione_Articolo + '</td></tr>';\r\n    //                     });\r\n\r\n    //                     // recupero dati di missione\r\n    //                     if (obj.epObj.Id_Percorso) {\r\n    //                         req.onreadystatechange = function () {\r\n    //                             if (req.readyState == 4 && req.status == 200) {\r\n    //                                 var mData = JSON.parse(req.responseText);\r\n\r\n    //                                 if (mData.length > 0) htmlString += '<tr><th scope=\"row\">MISSIONE:<td>' + mData[0].TipoMissione + \"<br/>\" + mData[0].Destinazione + '</td></tr>';\r\n\r\n    //                                 htmlString += '</tbody></table>';\r\n\r\n    //                                 var popover = $(document.getElementById(\"divSVGContainer\")).find('#' + tmpId);\r\n    //                                 popover.html(htmlString);\r\n\r\n    //                                 popover = $(document.getElementById(\"divSVGContainer\")).find('.popover');\r\n    //                                 if (popover) popover.popover('update');\r\n    //                             }\r\n    //                         };\r\n\r\n    //                         req.open(\"POST\", logycalStateUrl + '/entities/get', true);\r\n\r\n    //                         req.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\r\n\r\n    //                         req.send(JSON.stringify({\r\n    //                             \"EntityName\": \"AwmConfig.vMissioni\",\r\n    //                             \"FilterParameters\": [{ \"Name\": \"Id_Missione\", \"DbType\": 0, \"Value\": obj.epObj.Id_Percorso, \"Operator\": 0 }]\r\n    //                         }));\r\n    //                     } else {\r\n    //                         htmlString += '</tbody></table>';\r\n\r\n    //                         var popover = $(document.getElementById(\"divSVGContainer\")).find('#' + tmpId);\r\n    //                         popover.html(htmlString);\r\n\r\n    //                         popover = $(document.getElementById(\"divSVGContainer\")).find('.popover');\r\n    //                         if (popover) popover.popover('update');\r\n    //                     }\r\n    //                 }\r\n    //             };\r\n\r\n    //             req.open(\"POST\", logycalStateUrl + '/entities/get', true);\r\n\r\n    //             req.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\r\n\r\n    //             req.send(JSON.stringify({\r\n    //                 \"EntityName\": \"AwmConfig.vUdcDettaglio\",\r\n    //                 \"FilterParameters\": [{ \"Name\": \"Id_Udc\", \"DbType\": 8, \"Value\": obj.Id_Udc, \"Operator\": 0 }],\r\n    //                 //\"OrderParameters\": [{ \"Name\": \"Id_Missione\", \"Descending\": false }, { \"Name\": \"Sorgente\" }],\r\n    //                 \"Pagination\": {\r\n    //                     \"Page\": 1,\r\n    //                     \"PageSize\": 25\r\n    //                 }\r\n    //             }));\r\n    //         }\r\n\r\n    //         return htmlString;\r\n    //     },\r\n    //     sanitize: false\r\n    // });\r\n\r\n    // $(element).on('show.bs.popover', function () {\r\n    //     clearPopovers();\r\n    // });\r\n}\r\n\r\nfunction clearPopovers() {\r\n    // $(document.getElementById(\"divSVGContainer\")).find(\".popover\").popover('hide');\r\n}\r\n\r\nfunction logicalStateFetch(url, svgdoc, Rotation, Scale, Force) {\r\n    if (!svgdoc.getAnimations().some(a => {\r\n        return (a.playState == 'paused')\r\n    }) || Force) {\r\n        logycalStatexmlHttp = new XMLHttpRequest();\r\n\r\n        logycalStatexmlHttp.onreadystatechange = function () {\r\n            if (logycalStatexmlHttp.readyState == 4 && logycalStatexmlHttp.status == 200) {\r\n                try {\r\n                    var data = JSON.parse(logycalStatexmlHttp.responseText);\r\n\r\n                    // Se è specificata una scala faccio un ovverride dei dati dimensionali.\r\n                    data = data.map(function (obj) {\r\n                        obj.LARGHEZZA = obj.LARGHEZZA ? obj.LARGHEZZA / Scale : obj.LARGHEZZA;\r\n                        obj.PROFONDITA = obj.PROFONDITA ? obj.PROFONDITA / Scale : obj.PROFONDITA;\r\n                        obj.ALTEZZA = obj.ALTEZZA ? obj.ALTEZZA / Scale : obj.ALTEZZA;\r\n                        obj.LARGHEZZATUNNEL = obj.LARGHEZZATUNNEL ? obj.LARGHEZZATUNNEL / Scale : obj.LARGHEZZATUNNEL;\r\n                        obj.OffsetSottoComponente = obj.OffsetSottoComponente ? obj.OffsetSottoComponente / Scale : obj.OffsetSottoComponente;\r\n                        obj.QuotaDeposito = obj.QuotaDeposito ? obj.QuotaDeposito / Scale : obj.QuotaDeposito;\r\n                        obj.QuotaDepositoX = obj.QuotaDepositoX ? obj.QuotaDepositoX / Scale : obj.QuotaDepositoX;\r\n                        obj.posHeight = obj.posHeight ? obj.posHeight / Scale : obj.posHeight;\r\n                        obj.posLength = obj.posLength ? obj.posLength / Scale : obj.posLength;\r\n                        obj.posWidth = obj.posWidth ? obj.posWidth / Scale : obj.posWidth;\r\n                        obj.PosX = obj.PosX ? obj.PosX / Scale : obj.PosX;\r\n\r\n                        if (arrowFlag == false) {\r\n                            obj.Id_Percorso = null;\r\n                            obj.Sequenza_Percorso = null;\r\n                        }\r\n\r\n                        return obj;\r\n                    });\r\n\r\n                    // Se ASI ARRAY VUOTO POPOLO\r\n                    if (ASIArray.length == 0 || Force) {\r\n                        data.forEach(function (ASI) {\r\n                            var obj = ASIArray.find(function (asiItem) {\r\n                                return asiItem.ASI == ASI.SORG;\r\n                            });\r\n\r\n                            if (!obj) {\r\n                                obj = {\r\n                                    ASI: ASI.SORG,\r\n                                    ID_COMPONENTE: ASI.ID_COMPONENTE,\r\n                                    PIANO: ASI.PIANO,\r\n                                    COLONNA: ASI.COLONNA,\r\n                                    PARTITION: ASI.PARTITION,\r\n                                    Id_Percorso: null,\r\n                                    Sequenza_Percorso: null,\r\n                                    Id_Tipo_Stato_Percorso: null,\r\n                                    svgElement: [],\r\n                                    Rotation: ASI.Rotation,\r\n                                    udcObjArr: [],\r\n                                    hasFault: false,\r\n                                    hasWarning: false,\r\n                                    ALTEZZA: ASI.posHeight * Scale,\r\n                                    LUNGHEZZA: ASI.posLength * Scale,\r\n                                    LARGHEZZA: ASI.posWidth * Scale\r\n                                };\r\n\r\n                                ASIArray.push(obj);\r\n\r\n                                // RENDERIUNG SCAFFALI\r\n                                if (ASI.ID_TIPO_COMPONENTE == 'S') {\r\n                                    // SE SONO UNA CELLA DELLO SCAFFALE DEVO TROVARE L ELEMENTO SCAFFALE E FARE IL RENDERING Lì.\r\n                                    var rackOriginObjX = svgdoc.querySelector(\"[id*='\" + ASI.SORG.substring(0, 4) + '.' + ASI.PARTITION + '.' + 'x' + \"']\");\r\n                                    var rackOriginObjZ = svgdoc.querySelector(\"[id*='\" + ASI.SORG.substring(0, 4) + '.' + ASI.PARTITION + '.' + 'z' + \"']\");\r\n\r\n                                    // SE HO TROVATO ENTRAMBE LE DIRETTRICI DISEGNO LA PARTIZIONE.\r\n                                    if (rackOriginObjX && rackOriginObjZ) {\r\n                                        var renderLength = 0;\r\n\r\n                                        var prevObj = ASIArray.find(function (asiItem) {\r\n                                            return asiItem.ID_COMPONENTE == ASI.ID_COMPONENTE && asiItem.PIANO == ASI.PIANO && asiItem.PARTITION == ASI.PARTITION && asiItem.COLONNA == ASI.COLONNA - 1;\r\n                                        });\r\n\r\n                                        // RECUPERO LA POSIZIONE DI PARTENZA (O L INIZIO DELLO SCAFFALE O IL COMPONENTE PRECEDENTE) \r\n                                        if (prevObj) renderLength = prevObj.svgElement[0].renderLength - prevObj.svgElement[0].OffsetSottoComponente + prevObj.svgElement[0].LARGHEZZATUNNEL + 500 / Scale;\r\n\r\n                                        // OFFSET CHE INDICA IL DISTANZIAMENTO TRA LE COLONNE\r\n                                        if (ASI.svgOFFSET) renderLength += ASI.svgOFFSET * 3.543 / Scale;\r\n\r\n                                        // OFFSET CHE INDICA DOVE LA CELLA PARTE RISPETTO AL TUNNEL.\r\n                                        if (ASI.OffsetSottoComponente) renderLength += ASI.OffsetSottoComponente * 3.543 / Scale;\r\n\r\n                                        var deltaX = rackOriginObjX.getPointAtLength(renderLength).x - rackOriginObjX.getPointAtLength(0).x;\r\n                                        var deltaY = rackOriginObjX.getPointAtLength(renderLength).y - rackOriginObjX.getPointAtLength(0).y;\r\n\r\n                                        var x1Start = rackOriginObjZ.getPointAtLength(0).x + deltaX;\r\n                                        var y1Start = rackOriginObjZ.getPointAtLength(0).y + deltaY;\r\n                                        var x2Start = rackOriginObjZ.getPointAtLength(ASI.posLength * 3.543).x + deltaX;\r\n                                        var y2Start = rackOriginObjZ.getPointAtLength(ASI.posLength * 3.543).y + deltaY;\r\n\r\n                                        deltaX = rackOriginObjX.getPointAtLength(renderLength + ASI.posWidth * 3.543).x - rackOriginObjX.getPointAtLength(0).x;\r\n                                        deltaY = rackOriginObjX.getPointAtLength(renderLength + ASI.posWidth * 3.543).y - rackOriginObjX.getPointAtLength(0).y;\r\n\r\n                                        var x1End = rackOriginObjZ.getPointAtLength(0).x + deltaX;\r\n                                        var y1End = rackOriginObjZ.getPointAtLength(0).y + deltaY;\r\n                                        var x2End = rackOriginObjZ.getPointAtLength(ASI.posLength * 3.543).x + deltaX;\r\n                                        var y2End = rackOriginObjZ.getPointAtLength(ASI.posLength * 3.543).y + deltaY;\r\n\r\n                                        var partitionObj = svgdoc.createElementNS(svgdoc.rootElement.namespaceURI, 'polygon');\r\n                                        var pWrap = svgdoc.createElementNS(svgdoc.rootElement.namespaceURI, 'g');\r\n                                        pWrap.append(partitionObj);\r\n\r\n                                        var points = \"\";\r\n                                        points += x1Start + \",\" + y1Start;\r\n                                        points += \" \" + x2Start + \",\" + y2Start;\r\n                                        points += \" \" + x2End + \",\" + y2End;\r\n                                        points += \" \" + x1End + \",\" + y1End;\r\n\r\n                                        partitionObj.setAttributeNS(null, \"points\", points);\r\n                                        partitionObj.setAttributeNS(null, \"id\", ASI.SORG);\r\n                                        partitionObj.style.pointerEvents = 'auto'\r\n\r\n                                        gpart.appendChild(pWrap);\r\n\r\n                                        if (ASI.ID_TIPO_PARTIZIONE == 'OO') partitionObj.setAttributeNS(null, \"fill\", \"#333333\"); else partitionObj.setAttributeNS(null, \"fill\", \"#C2C2C2\");\r\n\r\n                                        obj.svgElement.push({\r\n                                            grpObj: partitionObj,\r\n                                            x: null,\r\n                                            y: null,\r\n                                            txtObj: null,\r\n                                            renderLength: renderLength,\r\n                                            LARGHEZZATUNNEL: ASI.LARGHEZZATUNNEL * 3.543,\r\n                                            svgOFFSET: ASI.svgOFFSET * 3.543 || 0,\r\n                                            OffsetSottoComponente: ASI.OffsetSottoComponente * 3.543 || 0,\r\n                                            yScale: 1,\r\n                                            xScale: 1,\r\n                                            rackOriginObjX: rackOriginObjX,\r\n                                            rackOriginObjZ: rackOriginObjZ,\r\n                                            center: getRelativeXY(partitionObj.getBBox().x + partitionObj.getBBox().width / 2, partitionObj.getBBox().y + partitionObj.getBBox().height / 2, svg, partitionObj)\r\n                                        });\r\n\r\n                                        initSl(obj, partitionObj);\r\n\r\n                                        rackOriginObjX.setAttributeNS(null, 'visibility', 'hidden');\r\n                                        rackOriginObjZ.setAttributeNS(null, 'visibility', 'hidden');\r\n                                    }\r\n                                } else {\r\n                                    // RENDERING DI TUTTO QUELLO CHE NON è SCAFFALE (CENSITO SUL FILE SVG DEL GRAFICO)\r\n                                    //var elArray = svgdoc.querySelectorAll(\"[id*='\" + ASI.SORG + \"']\")\r\n                                    var elArray = svgdoc.querySelectorAll(\"[id*='\" + ASI.SORG + \"']:not([id*='flowPath'])\");\r\n                                    //Se non trovo corrispondenza dell'elemento nel file SVG scateno un errore.\r\n                                    if (elArray.length == 0) console.error(ASI.SORG + \" non trovato nell'SVG.\")\r\n                                    else elArray.forEach(function (ItemG, index) {\r\n                                        //Calcolo rapporto tra la larghezza e la lunghezza dell'elemento con l obiettivo di caricare il file con le proporzioni + simili alle dimensioni dell'elemento stesso.\r\n                                        var wL = ItemG.getBBox().width / ItemG.getBBox().height;\r\n                                        //Capire per quali file ha senso gestire la misura diversa.\r\n                                        if (ASI.svg && ASI.svg.includes('rulliera.')) {\r\n                                            if (wL > 2 || wL < 0.5) {\r\n                                                ASI.svg = ASI.svg.replace('rulliera.', 'rullieraL.');\r\n                                            } else if (wL > 1.3 || wL <= 0.7) {\r\n                                                ASI.svg = ASI.svg.replace('rulliera.', 'rullieraM.');\r\n                                            }\r\n                                        }\r\n\r\n                                        var req = new XMLHttpRequest();\r\n\r\n                                        req.open(\"GET\", ASI.svg.split(',')[index], true);\r\n\r\n                                        req.onload = function (e) {\r\n                                            var parser = new DOMParser();\r\n                                            var componentSvg = parser.parseFromString(req.responseText, \"image/svg+xml\");\r\n                                            var g = componentSvg.getElementsByTagName('g')[0];\r\n                                            var center;\r\n\r\n                                            //SCALA\r\n                                            var xScale = 1,\r\n                                                yScale = 1;\r\n\r\n                                            var flowPath = null;\r\n\r\n                                            if (ASI.ID_TIPO_COMPONENTE == 'T') {\r\n                                                var i = ASI.SORG.length + 1;\r\n                                                do {\r\n                                                    flowPath = svgdoc.querySelector(\"[id^='flowPath\" + ASI.SORG.substring(0, i) + \"']\");\r\n                                                    i -= 1;\r\n                                                    //Se sono una lettera fermo la ricerca.\r\n                                                } while (!flowPath && i > 1 && isNaN(ASI.SORG.charAt(i)) == false);\r\n                                            }\r\n                                            \r\n\r\n\r\n                                            center = getRelativeXY(ItemG.getBBox().x + ItemG.getBBox().width / 2, ItemG.getBBox().y + ItemG.getBBox().height / 2, svg, ItemG);\r\n\r\n                                            //Se non trovo alcun SVG associato all'item allora creo il gruppo attorno all'elemento individuato\r\n                                            //Se trovo il file SVG allora lo posiziono sopra all'elemento esistente e lo rimuovo.\r\n                                            if (!g) {\r\n                                                g = svgdoc.createElementNS(svgdoc.rootElement.namespaceURI, 'g');\r\n                                                gpart.appendChild(g);\r\n\r\n                                                ItemG.removeAttributeNS(null, 'id');\r\n\r\n                                                if (flowPath) {\r\n                                                    ItemG.removeAttributeNS(null, 'transform');\r\n                                                    ItemG.setAttributeNS(null, 'x', 0);\r\n                                                    ItemG.setAttributeNS(null, 'y', 0);\r\n\r\n                                                    if (ItemG.getBBox().width > ItemG.getBBox().height) {\r\n                                                        var width = ItemG.getBBox().height;\r\n                                                        var height = ItemG.getBBox().width;\r\n                                                        ItemG.setAttributeNS(null, 'width', width);\r\n                                                        ItemG.setAttributeNS(null, 'height', height);\r\n                                                    }\r\n                                                }\r\n\r\n                                                g.id = ASI.SORG;\r\n                                                g.appendChild(ItemG);\r\n                                            } else {\r\n                                                g.id = ASI.SORG + '-' + index;\r\n\r\n                                                var rTf = \"\";\r\n\r\n                                                var pWrap = svgdoc.createElementNS(svgdoc.rootElement.namespaceURI, 'g');\r\n                                                pWrap.appendChild(g);\r\n\r\n                                                if (!flowPath) {\r\n                                                    gpart.appendChild(pWrap);\r\n                                                    // ROTAZIONE NORMALIZZANDO DIMENSIONI LARGHEZZA / ALTEZZA, AGGIUNGENDO LA ROTAZIONE SE LARGHEZZA è > DI ALTEZZA.\r\n                                                    var elRotation = decomposeMatrix(ItemG.getCTM()).rotation;\r\n                                                    if (ItemG.getBBox().width > ItemG.getBBox().height) elRotation += 90;\r\n                                                    if (elRotation) rTf = \"rotate(\" + elRotation + ' ' + center.x + ' ' + center.y + \")\";\r\n                                                } else {\r\n                                                    var fpGRoup = svgdoc.getElementById('gMotion' + flowPath.id);\r\n                                                    if (!fpGRoup) {\r\n                                                        fpGRoup = svgdoc.createElementNS(svgdoc.rootElement.namespaceURI, 'g');\r\n                                                        fpGRoup.id = 'gMotion' + flowPath.id;\r\n                                                        svg.appendChild(fpGRoup);\r\n                                                    }\r\n                                                    fpGRoup.appendChild(pWrap);\r\n                                                }\r\n\r\n                                                xScale = (ItemG.getBBox().width > ItemG.getBBox().height ? ItemG.getBBox().height : ItemG.getBBox().width) * decomposeMatrix(ItemG.getCTM()).scaleX / g.getBBox().width;\r\n                                                yScale = (ItemG.getBBox().width > ItemG.getBBox().height ? ItemG.getBBox().width : ItemG.getBBox().height) * decomposeMatrix(ItemG.getCTM()).scaleY / g.getBBox().height;\r\n\r\n                                                //TRANSLATE CHE TIENE CONTO DEL DELTA X (CHE PUò ESSERE ALTEZZA - LARGHEZZA IN BASE ALLA ROTAZIONE) COSì COME Y SEMPRE CENTRANDO L OGGETTO\r\n                                                var tTf = \"\";\r\n                                                if (!flowPath) tTf = 'translate(' + [center.x - g.getBBox().width * xScale / 2, center.y - g.getBBox().height * yScale / 2] + \")\";\r\n\r\n                                                var sTf = \"\";\r\n                                                sTf = 'scale(' + xScale + ',' + yScale + ')';\r\n\r\n                                                var tS = rTf + tTf + sTf;\r\n\r\n                                                g.setAttributeNS(null, 'transform', tS);\r\n\r\n                                                g.style.pointerEvents = 'auto'\r\n\r\n                                                ItemG.setAttributeNS(null, 'visibility', 'hidden');\r\n                                            }\r\n\r\n                                            var text = null;\r\n\r\n                                            //if (flowPath && index == 0) {\r\n                                            //    text = svgdoc.createElementNS(\"http://www.w3.org/2000/svg\", 'text');\r\n                                            //    text.setAttributeNS(null, \"x\", 0);\r\n                                            //    text.setAttributeNS(null, \"y\", 0);\r\n                                            //    text.setAttributeNS(null, \"style\", \"fill: blue\");\r\n                                            //    text.setAttributeNS(null, \"font-size\", 3000 / Scale);\r\n                                            //    text.setAttributeNS(null, 'font-family', 'Segoe UI');\r\n                                            //    text.appendChild(svgdoc.createTextNode(ASI.SORG));\r\n                                            //    svg.appendChild(text);\r\n                                            //}\r\n\r\n                                            obj.svgElement.push({\r\n                                                grpObj: g,\r\n                                                x: null,\r\n                                                y: null,\r\n                                                txtObj: text,\r\n                                                flowPath: flowPath,\r\n                                                Rotation: ASI.Rotation,\r\n                                                xScale: xScale,\r\n                                                yScale: yScale,\r\n                                                center: center\r\n                                            });\r\n\r\n                                            initSl(obj, g);\r\n\r\n                                            //Se l'elemento ha una flow path associata lo muobo al punto 0 e la nascondo.\r\n                                            if (flowPath) {\r\n                                                if (flowPath.tagName == 'path')\r\n                                                    g.style.offsetPath = \"path('\" + flowPath.getAttributeNS(null, 'd') + \"')\"\r\n                                                else if ((flowPath.tagName == 'line'))\r\n                                                    g.style.offsetPath = \"path('M\" + flowPath.getAttributeNS(null, 'x1') + ' ' + flowPath.getAttributeNS(null, 'y1') + ',L' + flowPath.getAttributeNS(null, 'x2') + ' ' + flowPath.getAttributeNS(null, 'y2') + \"')\";\r\n\r\n                                                g.style.offsetRotate = 'auto 90deg';\r\n                                                g.style.offsetAnchor = (g.getBBox().x + g.getBBox().width / 2 * xScale) + 'px ' + (g.getBBox().y + g.getBBox().height / 2 * yScale) + 'px'\r\n                                                flowPath.setAttributeNS(null, 'visibility', 'hidden');\r\n                                                g.style.willChange = 'transform';\r\n                                                transform(obj, 0);\r\n                                            }\r\n\r\n                                            obj.persistent = true;\r\n                                        };\r\n\r\n                                        req.send();\r\n                                    });\r\n                                }\r\n                            }\r\n                        });\r\n\r\n                        //Alla prima chiamata nascondo tutto quello che non deve essere visibile.\r\n                        if (!Force) {\r\n                            try {\r\n                                svgdoc.addEventListener('pointerover', (e) => {\r\n                                    if (e.target.parentElement) {\r\n                                        var statusLayer = svgdoc.createElementNS(\"http://www.w3.org/2000/svg\", 'rect');\r\n                                        statusLayer.setAttributeNS(null, \"class\", 'statusLayer');\r\n                                        statusLayer.style.pointerEvents = 'none'\r\n                                        statusLayer.setAttributeNS(null, \"width\", e.target.parentElement.getBBox().width);\r\n                                        statusLayer.setAttributeNS(null, \"height\", e.target.parentElement.getBBox().height);\r\n                                        statusLayer.setAttributeNS(null, \"x\", e.target.parentElement.getBBox().x);\r\n                                        statusLayer.setAttributeNS(null, \"y\", e.target.parentElement.getBBox().y);\r\n                                        e.target.parentElement.append(statusLayer);\r\n                                        e.target.parentElement.onpointerout = () => {\r\n                                            statusLayer.remove()\r\n                                        };\r\n                                    }\r\n                                });\r\n\r\n                                svgdoc.addEventListener(\"pointerout\", function (e) {\r\n                                    if (e.target.parentElement) e.target.parentElement.querySelectorAll(\".statusLayer\").forEach(e => e.remove());\r\n                                });\r\n\r\n                                svg.getElementById(\"macchine\")?.setAttributeNS(null, 'visibility', 'hidden');\r\n                                svg.getElementById(\"catenarie\")?.setAttributeNS(null, 'visibility', 'hidden');\r\n                                svg.getElementById(\"rulliere\")?.setAttributeNS(null, 'visibility', 'hidden');\r\n                                svg.getElementById(\"Switcher\")?.setAttributeNS(null, 'visibility', 'hidden');\r\n                                svg.getElementById(\"ralle\")?.setAttributeNS(null, 'visibility', 'hidden');\r\n                                svg.getElementById(\"magazzino\")?.setAttributeNS(null, 'visibility', 'hidden');\r\n                                svg.getElementById(\"flowpath\")?.setAttributeNS(null, 'visibility', 'hidden');\r\n\r\n                            } catch (e) {\r\n                                console.log(e);\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    //rimuovo tutti gli elementi che non sono + nella query della waTracking (non vanno + tracciati.)\r\n                    ASIArray.forEach(function (asiItem) {\r\n                        asiItem.udcObjArr.filter(function (udcObjItem) {\r\n                            return data.find(function (item) {\r\n                                return udcObjItem.Id_Udc == item.Id_Udc;\r\n                            }) == undefined;\r\n                        }).forEach(function (item) {\r\n                            // rimuovo dal rendering\r\n                            item.udcObj.remove();\r\n                            item.Id_Udc = null;\r\n                        });\r\n\r\n                        asiItem.udcObjArr = asiItem.udcObjArr.filter(function (obj) {\r\n                            return obj.Id_Udc != null;\r\n                        });\r\n                    });\r\n\r\n                    //rimuovo tutte le sequenze che non sono più attiva.\r\n                    ASIArray.filter(function (seqItem) {\r\n                        return data.find(function (item) {\r\n                            return seqItem.Id_Percorso == item.Id_Percorso && seqItem.Sequenza_Percorso == item.Sequenza_Percorso;\r\n                        }) == undefined;\r\n                    }).forEach(function (item) {\r\n                        // rimuovo dal rendering\r\n                        item.svgElement.forEach(function (svgEl) {\r\n                            // può essere che non abbia una sequenza se non ho l'item sul layout nominato ???\r\n                            if (svgEl.seqObj) svgEl.seqObj.remove();\r\n                            svgEl.seqObj = null;\r\n                        });\r\n\r\n                        item.Id_Percorso = null;\r\n                        item.Sequenza_Percorso = null;\r\n                        item.DEST = null;\r\n                    });\r\n\r\n                    // aggiorno le posizioni dell udc, delle macchine, delle sequenze.\r\n                    data.forEach(function (item) {\r\n                        var ASI;\r\n\r\n                        ASI = ASIArray.find(function (ASIArrayObj) {\r\n                            return ASIArrayObj.ASI == item.SORG;\r\n                        });\r\n\r\n                        try {\r\n                            //FRECCE SEQUENZE\r\n                            if (item.DEST) {\r\n                                // recupero l'eventuale oggetto sequenza\r\n                                var seqObj = ASIArray.find(function (seqItem) {\r\n                                    return seqItem.Id_Percorso == item.Id_Percorso && seqItem.Sequenza_Percorso == item.Sequenza_Percorso;\r\n                                });\r\n\r\n                                // derfinisco il colore da usare per disegnare la freccia in base allo stato del passo\r\n                                var svgItemDest = void 0;\r\n                                var color = void 0;\r\n                                switch (item.Id_Tipo_Stato_Percorso) {\r\n                                    case 2:\r\n                                        color = \"green\";\r\n                                        break;\r\n                                    case 4:\r\n                                        color = \"yellow\";\r\n                                        break;\r\n                                    default:\r\n                                        color = \"#007bff\";\r\n                                }\r\n\r\n                                // se non ho un oggetto sequenza lo creo altrimenti gli cambio colore.\r\n                                if (!seqObj) {\r\n                                    svgItemDest = ASIArray.find(function (ASIArrayObj) {\r\n                                        return ASIArrayObj.ASI == item.DEST;\r\n                                    });\r\n                                    // disegno l udc e come riferimento di posizione uso il centro del gruppo asi nell svg ex 'g2A01'\r\n                                    var seqPath = svgdoc.createElementNS(\"http://www.w3.org/2000/svg\", 'path');\r\n                                    if (svgItemDest && svgItemDest.svgElement.length > 0 && ASI.svgElement.length > 0) {\r\n                                        gArrows.appendChild(seqPath);\r\n                                        var destPoint = svgItemDest.svgElement[0].center;\r\n                                        if (svgItemDest.svgElement[0].flowPath) {\r\n                                            destPoint = svgItemDest.svgElement[0].flowPath.getPointAtLength(svgItemDest.PosX);\r\n                                            svgdoc.getElementById('gMotion' + svgItemDest.svgElement[0].flowPath.id).appendChild(seqPath);\r\n                                        }\r\n                                        var sPoint =  ASI.svgElement[0].center;\r\n                                        if (ASI.svgElement[0].flowPath){\r\n                                            sPoint = ASI.svgElement[0].flowPath.getPointAtLength(ASI.PosX);\r\n                                            svgdoc.getElementById('gMotion' + ASI.svgElement[0].flowPath.id).appendChild(seqPath);\r\n                                        }\r\n\r\n                                        if (ASI.svgElement[0].flowPath || svgItemDest.svgElement[0].flowPath) seqPath.style.willChange = 'transform';\r\n                                        \r\n                                        seqPath.setAttributeNS(null, \"d\", \"M\" + sPoint.x + \" \" + sPoint.y + \" L\" + destPoint.x + \" \" + destPoint.y);\r\n                                        seqPath.setAttributeNS(null, \"marker-end\", \"url(#markerTriangolo\" + item.Id_Tipo_Stato_Percorso) + \")\";\r\n                                        seqPath.style.stroke = color;\r\n                                        seqPath.style.strokeWidth = 300 / Scale;\r\n\r\n                                        ASI.Id_Percorso = item.Id_Percorso;\r\n                                        ASI.Sequenza_Percorso = item.Sequenza_Percorso;\r\n                                        ASI.Id_Tipo_Stato_Percorso = item.Id_Tipo_Stato_Percorso;\r\n                                        ASI.svgElement[0].seqObj = seqPath;\r\n                                        ASI.svgElement[0].destObj = svgItemDest.svgElement[0];\r\n                                        ASI.DEST = item.DEST;\r\n                                    }\r\n                                } else if (seqObj.Id_Percorso && seqObj.Id_Tipo_Stato_Percorso != item.Id_Tipo_Stato_Percorso) {\r\n                                    ASI.Id_Tipo_Stato_Percorso = item.Id_Tipo_Stato_Percorso;\r\n                                    ASI.svgElement[0].seqObj.style.stroke = color;\r\n                                    // creo la freccia che verrà assegnata come markerEnd della linea. DA FARE MEGLIO!\r\n                                    ASI.svgElement[0].seqObj.setAttributeNS(null, \"marker-end\", \"url(#markerTriangolo\" + item.Id_Tipo_Stato_Percorso + \")\");\r\n                                }\r\n                            }\r\n\r\n                            //TRACKING UDC\r\n                            var gUdc = null;\r\n                            var udc = null;\r\n\r\n                            if (item.Id_Udc != 0 && ASI.udcObjArr.findIndex(function (udcObjItem) {\r\n                                return item.Id_Udc == udcObjItem.Id_Udc;\r\n                            }) == -1) {\r\n                                // se l'item sta hostando un udc la disegno.\r\n                                // se esiste un udc con lo stesso Id disegnata prendo lei e la traslo.\r\n                                // tiro su tutte le istanze relative a quell udc (posso averne + d una perchè se lo stesso ASI è disegnato in punti diversi anche l udc a bordo lo sarà).\r\n                                var standingASI = null;\r\n                                var udcIndex = null;\r\n                                var udcObj = null;\r\n                                var _iteratorNormalCompletion = true;\r\n                                var _didIteratorError = false;\r\n                                var _iteratorError = undefined;\r\n\r\n                                try {\r\n                                    for (var _iterator = ASIArray[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\r\n                                        var asiItem = _step.value;\r\n\r\n                                        udcIndex = asiItem.udcObjArr.findIndex(function (udcObjItem) {\r\n                                            return item.Id_Udc == udcObjItem.Id_Udc;\r\n                                        });\r\n\r\n                                        if (udcIndex != -1) {\r\n                                            standingASI = asiItem;\r\n                                            break;\r\n                                        }\r\n                                    }\r\n                                } catch (err) {\r\n                                    _didIteratorError = true;\r\n                                    _iteratorError = err;\r\n                                } finally {\r\n                                    try {\r\n                                        if (!_iteratorNormalCompletion && _iterator.return) {\r\n                                            _iterator.return();\r\n                                        }\r\n                                    } finally {\r\n                                        if (_didIteratorError) {\r\n                                            throw _iteratorError;\r\n                                        }\r\n                                    }\r\n                                };\r\n\r\n                                if (standingASI) {\r\n                                    udcObj = standingASI.udcObjArr[udcIndex];\r\n                                    gUdc = standingASI.udcObjArr[udcIndex].udcObj;\r\n                                    udc = gUdc.getElementsByTagName('rect')[0];\r\n\r\n                                    if (gUdc) {\r\n                                        // Pulisco la prensenza logica sull ASI\r\n                                        standingASI.udcObjArr.splice(udcIndex, 1);\r\n                                    }\r\n\r\n                                    if (udcObj.LARGHEZZA / Scale != item.LARGHEZZA || udcObj.LUNGHEZZA / Scale != item.PROFONDITA) {\r\n                                        udcObj.LARGHEZZA = item.LARGHEZZA * Scale;\r\n                                        udcObj.LUNGHEZZA = item.PROFONDITA * Scale;\r\n                                        udcObj.xScale = item.LARGHEZZA * 3.453 / gUdc.getBBox().width;\r\n                                        udcObj.yScale = item.PROFONDITA * 3.453 / gUdc.getBBox().height;\r\n                                    }\r\n\r\n                                    moveUdc(udcObj, item, ASI);\r\n                                } else {\r\n                                    var req = new XMLHttpRequest();\r\n\r\n                                    req.open(\"GET\", item.svgUdc, true);\r\n\r\n                                    req.onload = function (e) {\r\n                                        var parser = new DOMParser();\r\n                                        var gUdc = parser.parseFromString(req.responseText, \"image/svg+xml\").getElementsByTagName('g')[0];\r\n                                        var width = (item.LARGHEZZA ? item.LARGHEZZA : 800 / Scale || 1) * 3.543;\r\n                                        var height = (item.PROFONDITA ? item.PROFONDITA : 1200 / Scale || 1) * 3.543;\r\n\r\n                                        var xScale = 1,\r\n                                            yScale = 1;\r\n\r\n                                        // Se non ho trovato il file aggiungo un quadrato.\r\n                                        if (!gUdc) {\r\n                                            gUdc = svgdoc.createElementNS(\"http://www.w3.org/2000/svg\", 'g');\r\n                                            gUdc.id = 'udc' + item.Id_Udc;\r\n                                            // disegno l udc e come riferimento di posizione uso il centro del gruppo asi nell svg ex 'g2A01'\r\n                                            udc = svgdoc.createElementNS(\"http://www.w3.org/2000/svg\", 'rect');\r\n                                            udc.setAttributeNS(null, \"width\", width);\r\n                                            udc.setAttributeNS(null, \"height\", height);\r\n                                            udc.setAttributeNS(null, \"x\", 0);\r\n                                            udc.setAttributeNS(null, \"y\", 0);\r\n                                            //udc.setAttributeNS(null, \"pointer-events\", \"none\");\r\n                                            udc.style.fill = item.udcColour || \"#007bff\";\r\n                                            gUdc.appendChild(udc);\r\n                                        } else {\r\n                                            svg.appendChild(gUdc);\r\n                                            xScale = width / gUdc.getBBox().width;\r\n                                            yScale = height / gUdc.getBBox().height;\r\n                                        }\r\n\r\n                                        gUdc.id = 'udc' + item.Id_Udc;\r\n\r\n                                        gUdc.style.pointerEvents = 'auto';\r\n\r\n                                        udcObj = {\r\n                                            Id_Udc: item.Id_Udc,\r\n                                            emptyUdc: true,\r\n                                            emptyUdcObj: null,\r\n                                            Codice_Udc: item.Codice_Udc,\r\n                                            udcObj: gUdc,\r\n                                            epObj: item,\r\n                                            xScale: xScale,\r\n                                            yScale: yScale,\r\n                                            LARGHEZZA: item.LARGHEZZA * Scale,\r\n                                            LUNGHEZZA: item.PROFONDITA * Scale\r\n                                        };\r\n\r\n                                        initSl(udcObj, gUdc);\r\n\r\n                                        moveUdc(udcObj, item, ASI);\r\n                                    };\r\n\r\n                                    req.addEventListener(\"error\", function () {\r\n                                        setTimeout(function () {\r\n                                            req.open(\"GET\", item.svgUdc, true);\r\n                                            req.send();\r\n                                        }, 1000);\r\n                                    });\r\n\r\n                                    req.send();\r\n                                }\r\n                            }\r\n\r\n                            //LOCKICON\r\n                            if ((item.LOCKED != ASI.LOCKED || ASI.LOCKED == undefined) && ASI.svgElement.length > 0) {\r\n                                ASI.LOCKED = item.LOCKED;\r\n                                ASI.Motivo_Blocco = item.Motivo_Blocco;\r\n                                if (item.LOCKED) {\r\n                                    setTimeout(function(){\r\n                                        var req = new XMLHttpRequest();\r\n                                        req.open(\"GET\", 'App/SVG/Icons/lock.svg', true);\r\n                                        req.onload = function (e) {\r\n                                            var parser = new DOMParser();\r\n                                            var lockIcon = svgdoc.createElementNS(\"http://www.w3.org/2000/svg\", 'g');\r\n                                            lockIcon.setAttributeNS(null, \"id\", \"lock\" + ASI.ASI);\r\n                                            lockIcon.appendChild(parser.parseFromString(req.responseText, \"image/svg+xml\").getElementsByTagName('svg')[0]);\r\n                                            lockIcon.childNodes[0].setAttributeNS(null, \"width\", 60);\r\n                                            lockIcon.childNodes[0].setAttributeNS(null, \"height\", 60);\r\n                                            lockIcon.childNodes[0].setAttributeNS(null, \"viewbox\", '0 0 60 60');\r\n                                            ASI.svgElement[0].grpObj.parentElement.appendChild(lockIcon);\r\n\r\n                                            if (ASI.svgElement[0].flowPath){\r\n                                                lockIcon.style.offsetPath = ASI.svgElement[0].grpObj.style.offsetPath;\r\n                                                lockIcon.style.offsetDistance = ASI.PosX + 'px';\r\n                                                lockIcon.style.offsetRotate = \"auto \" + ASI.Rotation + 'deg'\r\n                                                lockIcon.style.willChange = \"transform\"\r\n                                                lockIcon.style.offsetAnchor = (lockIcon.getBBox().x + lockIcon.getBBox().width / 2) + 'px ' + (lockIcon.getBBox().y + lockIcon.getBBox().height / 2) + 'px'\r\n                                            } else {\r\n                                                lockIcon.setAttributeNS(null, 'transform','translate(' + [ASI.svgElement[0].center.x - 30, ASI.svgElement[0].center.y - 30] + \")\");\r\n                                            }\r\n\r\n                                            ASI.lockIcon = lockIcon\r\n                                        }\r\n                                        req.send();\r\n                                    },500);\r\n                                } else {\r\n                                    var lockIcon = svgdoc.getElementById(\"lock\" + ASI.ASI);\r\n                                    ASI.lockIcon = null;\r\n                                    if (lockIcon) lockIcon.remove();\r\n                                }\r\n                            }\r\n                        } catch (e) {\r\n                            console.log(e, e.message);\r\n                        }\r\n                    });\r\n\r\n                    // var popover = $(document.getElementById(\"divSVGContainer\")).find('.popover');\r\n                    // if (popover) popover.popover('update');\r\n                } catch (e) {\r\n                    console.log(e, e.message);\r\n                }\r\n            }\r\n        };\r\n\r\n        logycalStatexmlHttp.addEventListener('loadend', function () {\r\n            logycalStateTimer = setTimeout(logicalStateFetch, lTimerInterval, logycalStateUrl + \"/Scada/0/\" + selectedFloor, svgdoc, Rotation, Scale);\r\n        });\r\n\r\n        logycalStatexmlHttp.open(\"GET\", url, true); // true for asynchronous\r\n\r\n        logycalStatexmlHttp.send(null);\r\n    } else logycalStateTimer = setTimeout(logicalStateFetch, lTimerInterval, logycalStateUrl + \"/Scada/0/\" + selectedFloor, svgdoc, Rotation, Scale);\r\n}\r\n\r\nfunction physicalStateFetch(pUrl, Scale) {\r\n    if (!svgdoc.getAnimations().some(a => {\r\n        return (a.playState == 'paused')\r\n    })) {\r\n        physicalStatexmlHttp = new XMLHttpRequest();\r\n\r\n        physicalStatexmlHttp.onreadystatechange = function () {\r\n            if (physicalStatexmlHttp.readyState == 4 && physicalStatexmlHttp.status == 200) {\r\n                var jsonData = JSON.parse(physicalStatexmlHttp.responseText)\r\n\r\n                if (jsonData.filter(function (data) {\r\n                    return data.tagType == 10 && data.value == true;\r\n                }).length > 0) {\r\n                    if (!btnFault) {\r\n                        btnFault = document.createElement('button');\r\n                        btnFault.setAttribute(\"class\", \"btn btn-danger m-2 float-none\");\r\n                        btnFault.innerText = 'RESET FAULT'\r\n                        btnFault.onclick = function (e) {\r\n                            var req = new XMLHttpRequest();\r\n                            req.onreadystatechange = function () {\r\n                                if (req.readyState == 4 && req.status == 200) {\r\n                                    console.log(req.responseText);\r\n                                }\r\n                            };\r\n                            req.open(\"GET\", physicalStateUrl + '/psm/resetFault', true);\r\n                            req.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\r\n                            req.send();\r\n                        }\r\n                        contDiv.appendChild(btnFault);\r\n                    }\r\n                } else if (btnFault) {\r\n                    btnFault.remove();\r\n                    btnFault = null;\r\n                }\r\n\r\n                if (jsonData.filter(function (data) {\r\n                    return data.tagType == 9 && data.value == true;\r\n                }).length > 0) {\r\n                    if (!btnWarning) {\r\n                        btnWarning = document.createElement('button');\r\n                        btnWarning.setAttribute(\"class\", \"btn btn-warning m-2\");\r\n                        btnWarning.innerText = 'RESET WARNING'\r\n                        btnWarning.onclick = function (e) {\r\n                            var req = new XMLHttpRequest();\r\n                            req.onreadystatechange = function () {\r\n                                if (req.readyState == 4 && req.status == 200) {\r\n                                    console.log(req.responseText);\r\n                                }\r\n                            };\r\n                            req.open(\"GET\", physicalStateUrl + '/psm/resetWarning', true);\r\n                            req.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\r\n                            req.send();\r\n                        }\r\n                        contDiv.appendChild(btnWarning);\r\n                    }\r\n                } else if (btnWarning) {\r\n                    btnWarning.remove();\r\n                    btnWarning = null;\r\n                }\r\n\r\n                // TO DO : CAPIRE COME GESTIRE I TIPI DI TAGS\r\n                jsonData.filter(function (data) {\r\n                    return data.value != null && (data.tagType == 4 || data.tagType == 12 || data.tagType == 15);\r\n                }).forEach(function (tagObj) {\r\n                    var ASI = ASIArray.find(function (ASI) {\r\n                        return ASI.ASI == tagObj.asi;\r\n                    });\r\n\r\n                    if (ASI) {\r\n                        // GESTIONE ANIMAZIONE\r\n                        // se ho associato una flowPath (percorso) ed ho il posizionamento delle macchina allora il mio riferimento per posizionarmi sarà il punto del percorso tenendo conto delle sue trasformazioni.\r\n                        if (ASI.svgElement.length > 0 && tagObj.tagType == 15) transform(ASI, tagObj.value / Scale * 3.543);\r\n\r\n                        if (tagObj.tagType == 12 && ASI.activeSequence != tagObj.value) {\r\n                            if (tagObj.value == true) ASI.activeSequence = tagObj;\r\n                            else ASI.activeSequence = false;\r\n                        }\r\n                    }\r\n                });\r\n\r\n                // Gestione Fault e Warning\r\n                faultArray = jsonData.filter(function (data) {\r\n                    return data.value != null && data.value != false && data.tagType == 1;\r\n                });\r\n\r\n                ASIArray.filter(function (asiObj) {\r\n                    return asiObj.hasFault == true && asiObj.persistent == true && this.findIndex(function (asiInFault) {\r\n                        return asiObj.ASI.startsWith(asiInFault);\r\n                    }) == -1;\r\n                }, faultArray.map(function (item) {\r\n                    if (item.asi) return item.asi.split(',');\r\n                }).flat().filter(onlyUnique)).forEach(function (asiItem) {\r\n                    asiItem.hasFault = false;\r\n                    asiItem.svgElement.forEach(e => e.grpObj.querySelector(\".fault\").remove());\r\n                });\r\n\r\n                ASIArray.filter(function (asiObj) {\r\n                    return asiObj.hasFault == false && asiObj.persistent == true && this.findIndex(function (asiInFault) {\r\n                        return asiObj.ASI.startsWith(asiInFault);\r\n                    }) != -1;\r\n                }, faultArray.map(function (item) {\r\n                    if (item.asi) return item.asi.split(',');\r\n                }).flat().filter(onlyUnique)).forEach(function (asiItem) {\r\n                    asiItem.hasFault = true;\r\n                    asiItem.svgElement.forEach(el => {\r\n                        var faultRect = svgdoc.createElementNS(\"http://www.w3.org/2000/svg\", 'rect');\r\n                        faultRect.setAttributeNS(null, \"class\", 'fault');\r\n                        faultRect.setAttributeNS(null, \"width\", el.grpObj.getBBox().width);\r\n                        faultRect.setAttributeNS(null, \"height\", el.grpObj.getBBox().height);\r\n                        faultRect.setAttributeNS(null, \"x\", el.grpObj.getBBox().x);\r\n                        faultRect.setAttributeNS(null, \"y\", el.grpObj.getBBox().y);\r\n                        el.grpObj.appendChild(faultRect);\r\n                    })\r\n                });\r\n            }\r\n        };\r\n\r\n        physicalStatexmlHttp.addEventListener('loadend', function () {\r\n            physicalStateTimer = setTimeout(physicalStateFetch, pTimerInterval, pUrl, Scale);\r\n        });\r\n\r\n        physicalStatexmlHttp.open(\"GET\", pUrl, true);\r\n\r\n        physicalStatexmlHttp.send(null);\r\n    } else physicalStateTimer = setTimeout(physicalStateFetch, pTimerInterval, pUrl, Scale);\r\n}\r\n\r\nexport function dispose() {\r\n    if (logycalStatexmlHttp) logycalStatexmlHttp.abort();\r\n    if (physicalStatexmlHttp) physicalStatexmlHttp.abort();\r\n    clearTimeout(logycalStateTimer);\r\n    clearTimeout(physicalStateTimer);\r\n}\r\n\r\n","export default __webpack_public_path__ + \"static/media/6603-17.1ae13ed0.svg\";","import './App.css';\nimport svgLayout from './img/6603-17.svg';\nimport { SVG } from './script/svgIntegrationB';\n\nconst htmlContainer  =  <object id=\"objContainer\" data={svgLayout} />;\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      {htmlContainer}\n    </div>\n  );\n}\n\nconst cfg = {\n  Provider: 'http://localhost:10001',\n  Psm: 'http://localhost:10002',\n  // Rotation: 270,\n  Scale: 100\n}\n\nsetTimeout(function(){SVG(document.getElementById(\"objContainer\"), cfg)},3000);\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}